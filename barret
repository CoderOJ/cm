#ifndef CM_BARRET_H
#define CM_BARRET_H
#include <cstdint>
namespace cm{struct barret_reduction{private:uint64_t _2;uint64_t _3;int _4;static uint64_t _1(uint64_t a,uint64_t b){return(__uint128_t(a)*b)>>64;}public:barret_reduction(uint64_t mod){this->_2=mod;this->_4=63-__builtin_clzll(mod);this->_3=static_cast<uint64_t>((__uint128_t(1)<<(_4+64))/mod)+1;}uint64_t div(uint64_t x){return _1(x,_3)>>_4;}uint64_t mod(uint64_t x){return x-div(x)*_2;}};}
#endif
